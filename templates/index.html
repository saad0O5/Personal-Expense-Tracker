{% extends "base.html" %}

{% block content %}
<!-- Dashboard Section -->
<section id="dashboard-section" class="mt-4">
    <h2 class="mb-4"><i class="bi bi-speedometer2 me-2"></i>Dashboard</h2>

    <!-- Summary Stat Cards -->
    <div class="row g-3 mb-4">
        <div class="col-xl-3 col-md-6">
            <div class="card stat-card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <div class="stat-icon bg-primary bg-opacity-10 text-primary rounded-3 p-3 me-3">
                            <i class="bi bi-currency-dollar fs-4"></i>
                        </div>
                        <div>
                            <p class="text-muted mb-0 small">Total Spent</p>
                            <h4 class="fw-bold mb-0">$<span id="statTotalSpent" class="count-up" data-target="0">0.00</span></h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xl-3 col-md-6">
            <div class="card stat-card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <div class="stat-icon bg-success bg-opacity-10 text-success rounded-3 p-3 me-3">
                            <i class="bi bi-calendar-month fs-4"></i>
                        </div>
                        <div>
                            <p class="text-muted mb-0 small">This Month</p>
                            <h4 class="fw-bold mb-0">$<span id="statThisMonth" class="count-up" data-target="0">0.00</span></h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xl-3 col-md-6">
            <div class="card stat-card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <div class="stat-icon bg-warning bg-opacity-10 text-warning rounded-3 p-3 me-3">
                            <i class="bi bi-arrow-up-circle fs-4"></i>
                        </div>
                        <div>
                            <p class="text-muted mb-0 small">Highest Expense</p>
                            <h4 class="fw-bold mb-0">$<span id="statHighest">0.00</span></h4>
                            <span id="statHighestBadge" class="badge bg-secondary d-none"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xl-3 col-md-6">
            <div class="card stat-card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <div class="stat-icon bg-info bg-opacity-10 text-info rounded-3 p-3 me-3">
                            <i class="bi bi-receipt fs-4"></i>
                        </div>
                        <div>
                            <p class="text-muted mb-0 small">Transactions</p>
                            <h4 class="fw-bold mb-0"><span id="statTransactions" class="count-up" data-target="0">0</span></h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Charts Row -->
    <div class="row g-3 mb-4">
        <div class="col-lg-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-white fw-semibold">
                    <i class="bi bi-pie-chart me-2"></i>Spending by Category
                </div>
                <div class="card-body d-flex align-items-center justify-content-center">
                    <div class="chart-container" style="position:relative; width:100%; max-width:350px;">
                        <canvas id="categoryChart"></canvas>
                    </div>
                    <p id="categoryChartEmpty" class="text-muted text-center d-none">No data to display yet.</p>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-white fw-semibold">
                    <i class="bi bi-graph-up me-2"></i>Monthly Spending Trend
                </div>
                <div class="card-body d-flex align-items-center justify-content-center">
                    <div class="chart-container" style="position:relative; width:100%;">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Recent Expenses -->
    <div class="card border-0 shadow-sm mb-4">
        <div class="card-header bg-white fw-semibold">
            <i class="bi bi-clock-history me-2"></i>Recent Expenses
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover mb-0" id="recentExpensesTable">
                    <thead class="table-light">
                        <tr>
                            <th>Date</th>
                            <th>Description</th>
                            <th>Category</th>
                            <th class="text-end">Amount</th>
                        </tr>
                    </thead>
                    <tbody id="recentExpensesBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</section>

<!-- Filter / Search Section -->
<section id="filter-section" class="mb-3">
    <div class="card border-0 shadow-sm">
        <div class="card-body">
            <div class="row g-2 align-items-end">
                <div class="col-md-2">
                    <label for="filterCategory" class="form-label small fw-semibold">Category</label>
                    <select class="form-select form-select-sm" id="filterCategory">
                        <option value="">All Categories</option>
                        <option value="Food">Food</option>
                        <option value="Transport">Transport</option>
                        <option value="Health">Health</option>
                        <option value="Entertainment">Entertainment</option>
                        <option value="Shopping">Shopping</option>
                        <option value="Utilities">Utilities</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <label for="filterStartDate" class="form-label small fw-semibold">Start Date</label>
                    <input type="date" class="form-control form-control-sm" id="filterStartDate">
                </div>
                <div class="col-md-2">
                    <label for="filterEndDate" class="form-label small fw-semibold">End Date</label>
                    <input type="date" class="form-control form-control-sm" id="filterEndDate">
                </div>
                <div class="col-md-3">
                    <label for="filterKeyword" class="form-label small fw-semibold">Search</label>
                    <input type="text" class="form-control form-control-sm" id="filterKeyword"
                           placeholder="Search description...">
                </div>
                <div class="col-md-2">
                    <button class="btn btn-outline-secondary btn-sm w-100" id="btnClearFilters">
                        <i class="bi bi-x-circle me-1"></i>Clear Filters
                    </button>
                </div>
                <div class="col-md-1 text-end">
                    <span id="resultsCount" class="badge bg-primary d-none">0 results</span>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- All Expenses Section -->
<section id="expenses-section" class="mb-5">
    <h2 class="mb-3"><i class="bi bi-list-ul me-2"></i>All Expenses</h2>

    <!-- Expense Table -->
    <div class="card border-0 shadow-sm">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover mb-0" id="expensesTable">
                    <thead class="table-light">
                        <tr>
                            <th class="sortable" data-sort="date">
                                Date <i class="bi bi-arrow-down-up sort-icon text-muted"></i>
                            </th>
                            <th class="sortable" data-sort="description">
                                Description <i class="bi bi-arrow-down-up sort-icon text-muted"></i>
                            </th>
                            <th class="sortable" data-sort="category">
                                Category <i class="bi bi-arrow-down-up sort-icon text-muted"></i>
                            </th>
                            <th class="sortable text-end" data-sort="amount">
                                Amount <i class="bi bi-arrow-down-up sort-icon text-muted"></i>
                            </th>
                            <th class="text-center">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="expensesBody">
                    </tbody>
                </table>
            </div>
            <!-- Empty State -->
            <div id="emptyState" class="text-center py-5 d-none">
                <i class="bi bi-inbox display-1 text-muted"></i>
                <h4 class="mt-3 text-muted">No expenses yet</h4>
                <p class="text-muted">Start tracking your spending by adding your first expense.</p>
                <button class="btn btn-primary" id="btnAddFirstExpense"
                        data-bs-toggle="modal" data-bs-target="#expenseModal">
                    <i class="bi bi-plus-lg me-1"></i>Add your first expense
                </button>
            </div>
        </div>
    </div>
</section>
{% endblock %}
